(()=>{"use strict";var t={352:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=i(s(109)),a=i(s(122)),d=i(s(242));class o extends n.default{constructor(t){super(),this.tiles=t,this.reset=this.reset.bind(this),this.on(a.default.RESET,this.reset),this.on(d.default.EAT_APPLE,this.reset),this.reset()}reset(){const{tiles:t}=this;this.x=Math.floor(Math.random()*t.width),this.y=Math.floor(Math.random()*t.height)}onRender(t){const{x:e,y:s,tiles:i}=this,{size:n}=i;t.fillStyle="red",t.fillRect(e*n,s*n,n-2,n-2)}}e.default=o},190:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=i(s(109));class a extends n.default{constructor(t){super(),this.tiles=t}onRender(t){const{width:e,size:s,height:i}=this.tiles;t.fillStyle="rgb(0,0,48)",t.fillRect(0,0,e*s,i*s)}}e.default=a},228:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=i(s(959)),a=i(s(109)),d=i(s(122)),o=i(s(694));class l extends a.default{constructor(){super(),this.html=document.createElement("div"),this.buttons={up:document.createElement("div"),down:document.createElement("div"),left:document.createElement("div"),right:document.createElement("div")},this.onKeyDown=t=>{switch(t.key){case"ArrowLeft":n.default.dispatch(d.default.INPUT,o.default.LEFT);break;case"ArrowUp":n.default.dispatch(d.default.INPUT,o.default.UP);break;case"ArrowRight":n.default.dispatch(d.default.INPUT,o.default.RIGHT);break;case"ArrowDown":n.default.dispatch(d.default.INPUT,o.default.DOWN)}},this.render=!1,this.setupHTML(),document.addEventListener("keydown",this.onKeyDown)}onUpdate(){}setupHTML(){const{html:t,buttons:e}=this;t.classList.add("game-controller"),e.up.classList.add("game-controller-input");const s=document.createElement("span");s.innerText=o.default.UP,e.up.appendChild(s),e.up.onclick=()=>this.dispatch(d.default.INPUT,o.default.UP),e.down.classList.add("game-controller-input");const i=document.createElement("span");i.innerText=o.default.DOWN,e.down.appendChild(i),e.down.onclick=()=>this.dispatch(d.default.INPUT,o.default.DOWN),e.left.classList.add("game-controller-input");const n=document.createElement("span");n.innerText=o.default.LEFT,e.left.appendChild(n),e.left.onclick=()=>this.dispatch(d.default.INPUT,o.default.LEFT),e.right.classList.add("game-controller-input");const a=document.createElement("span");a.innerText=o.default.RIGHT,e.right.appendChild(a),e.right.onclick=()=>this.dispatch(d.default.INPUT,o.default.RIGHT);const l=document.createElement("div");l.classList.add("flex-row"),l.appendChild(e.up),l.appendChild(e.right);const u=document.createElement("div");u.classList.add("flex-row"),u.appendChild(e.left),u.appendChild(e.down),t.appendChild(l),t.appendChild(u)}}e.default=l},162:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=i(s(109)),a=i(s(122)),d=i(s(242));class o extends n.default{constructor(t,e){super(),this.overlay=t,this.score=e,this.createHTML(),this.onGameStart=this.onGameStart.bind(this),this.onGameReset=this.onGameReset.bind(this),this.onGameOver=this.onGameOver.bind(this),this.onSnakeEatSelf=this.onSnakeEatSelf.bind(this),this.on(a.default.START,this.onGameStart),this.on(a.default.RESET,this.onGameReset),this.on(a.default.GAME_OVER,this.onGameOver),this.on(d.default.EAT_SELF,this.onSnakeEatSelf)}createHTML(){const t=document.createElement("h1");t.innerText="Game Over",this.totalScore=document.createElement("span");const e=document.createElement("button");e.textContent="Restart",e.onclick=()=>this.dispatch(a.default.START),this.content=document.createElement("div"),this.content.classList.add("game-over","flex-column","justify-center","align-center"),this.content.append(t),this.content.append(this.totalScore),this.content.append(e)}onGameStart(){this.dispatch(a.default.RESET),this.dispatch(a.default.RESUME)}onGameReset(){this.overlay.close()}onGameOver(){const{totalScore:t,score:e,overlay:s,content:i}=this;this.dispatch(a.default.PAUSE),t.innerText=`Score: ${e.score}`,s.open(i)}onSnakeEatSelf(){this.dispatch(a.default.GAME_OVER)}}e.default=o},64:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this.html=document.createElement("div"),this.html.classList.add("game-overlay","flex-column","justify-center","align-center","hidden")}open(t){const{html:e}=this;e.append(t),e.classList.remove("hidden")}close(){const{html:t}=this;for(t.classList.add("hidden");t.lastChild;)t.removeChild(t.lastChild)}}},390:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=i(s(109)),a=i(s(122)),d=i(s(242));class o extends n.default{constructor(t,e){super(),this.snake=t,this.apple=e,this.html=document.createElement("div"),this.score=0,this.text=document.createElement("strong"),this.render=!1,this.setupHTML(),this.onGameReset=this.onGameReset.bind(this),this.onSnakeEatApple=this.onSnakeEatApple.bind(this),this.on(a.default.RESET,this.onGameReset),this.on(d.default.EAT_APPLE,this.onSnakeEatApple)}onUpdate(){this.snake.isAt(this.apple.position)&&this.dispatch(d.default.EAT_APPLE)}toText(){return`Score: ${this.score}`}setupHTML(){this.html.classList.add("game-score"),this.text.innerText=this.toText(),this.html.appendChild(this.text)}onGameReset(){this.score=0,this.text.innerText=this.toText()}onSnakeEatApple(){this.score+=1,this.text.innerText=this.toText()}}e.default=o},544:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=i(s(109)),a=i(s(122)),d=i(s(694)),o=i(s(242));class l extends n.default{constructor(t,e=5){super(),this.tiles=t,this.defaultTailLength=e,this.onGameReset=this.onGameReset.bind(this),this.onGameOver=this.onGameOver.bind(this),this.onGameResume=this.onGameResume.bind(this),this.onSnakeEatApple=this.onSnakeEatApple.bind(this),this.on(a.default.RESET,this.onGameReset),this.on(a.default.GAME_OVER,this.onGameOver),this.on(a.default.RESUME,this.onGameResume),this.on(o.default.EAT_APPLE,this.onSnakeEatApple),this.onGameReset()}isMoving(){return!this.inputDirection}isAt(t){return-1!==this.tail.findIndex((e=>e.isAt(t)))}onInput(t){t===d.default.LEFT&&this.inputDirection===d.default.RIGHT||t===d.default.UP&&this.inputDirection===d.default.DOWN||t===d.default.RIGHT&&this.inputDirection===d.default.LEFT||t===d.default.DOWN&&this.inputDirection===d.default.UP||(this.inputDirection=t,this.move())}onUpdate(){this.timerTriggered()?this.move():this.timerUpdate()}onRender(t){const{tiles:e,tail:s}=this;t.fillStyle="lime";for(let i in s)t.fillRect(s[i].x*e.size,s[i].y*e.size,e.size-2,e.size-2)}onGameReset(){this.inputDirection=null,this.x=0,this.y=0,this.tailLength=this.defaultTailLength,this.tail=[this.position.copy()],this.timerReset()}onGameOver(){this.input=!1}onGameResume(){this.input=!0}onSnakeEatApple(){this.tailLength+=1}timerReset(){this.timer=0}timerUpdate(){this.timer+=.15*this.tailLength}timerTriggered(){return this.timer>=this.tiles.size}move(){const{inputDirection:t,tiles:e,tail:s}=this;switch(t){case d.default.LEFT:this.x-=1;break;case d.default.UP:this.y-=1;break;case d.default.RIGHT:this.x+=1;break;case d.default.DOWN:this.y+=1;break;default:return}for(this.x<0&&(this.x=e.width-1),this.x>e.width-1&&(this.x=0),this.y<0&&(this.y=e.height-1),this.y>e.height-1&&(this.y=0),s.find((t=>t.isAt(this.position)))&&this.dispatch(o.default.EAT_SELF),s.push(this.position.copy());s.length>this.tailLength;)s.shift();this.timerReset()}}e.default=l},242:(t,e)=>{var s;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.EAT_SELF="snake-eat-self",t.EAT_APPLE="snake-eat-apple"}(s||(s={})),e.default=s},959:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{static dispatch(t,e){return window.dispatchEvent(e?new CustomEvent(t,{detail:e}):new CustomEvent(t))}static off(t,e){window.removeEventListener(t,e)}static on(t,e,s){window.addEventListener(t,e,{once:s})}}},328:function(t,e,s){var i=this&&this.__createBinding||(Object.create?function(t,e,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(e,s);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[s]}}),Object.defineProperty(t,i,n)}:function(t,e,s,i){void 0===i&&(i=s),t[i]=e[s]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var s in t)"default"!==s&&Object.prototype.hasOwnProperty.call(t,s)&&i(e,t,s);return n(e,t),e},d=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=a(s(184)),l=d(s(959)),u=d(s(122));e.default=class{constructor(){this.html=document.createElement("canvas"),this.ctx=this.html.getContext("2d"),this.running=!1,this.paused=!1,this.handlers={start:t=>this.onGameStart(t.detail),pause:()=>this.onGamePause(),resume:()=>this.onGameResume(),stop:()=>this.onGameStop(),resize:()=>this.onGameResize()},this.setupHTML(),l.default.on(u.default.START,this.handlers.start),l.default.on(u.default.STOP,this.handlers.stop)}start(t){l.default.dispatch(u.default.START,t)}stop(){l.default.dispatch(u.default.STOP)}resize(){l.default.dispatch(u.default.RESIZE)}setupHTML(){const{html:t}=this;t.classList.add("game-canvas")}onGamePause(){this.paused=!0}onGameResize(){l.default.dispatch(u.default.PAUSE),this.updateDisplay(),l.default.dispatch(u.default.RESUME)}onGameResume(){this.paused=!1}onGameStart(t){this.running||(this.scene=t,this.running=!0,this.paused=!1,l.default.on(u.default.PAUSE,this.handlers.pause),l.default.on(u.default.RESUME,this.handlers.resume),l.default.on(u.default.RESIZE,this.handlers.resize),l.default.dispatch(u.default.RESIZE),window.requestAnimationFrame((()=>this.frameLoop(Date.now()))))}onGameStop(){l.default.off(u.default.PAUSE,this.handlers.pause),l.default.off(u.default.RESUME,this.handlers.resume),l.default.off(u.default.RESIZE,this.handlers.resize),this.running=!1}frameLoop(t){if(!this.running)return;const e=Date.now();this.paused||(l.default.dispatch(u.default.UPDATE,(e-t)/1e3),l.default.dispatch(u.default.UPDATE_COMPLETE),l.default.dispatch(u.default.RENDER,this.ctx),l.default.dispatch(u.default.RENDER_COMPLETE)),window.requestAnimationFrame((()=>this.frameLoop(e)))}updateDisplay(){const{html:t,scene:e}=this;switch((0,o.getDisplay)(e.ratio)){case o.default.LANDSCAPE:case o.default.PORTRAIT:t.width=e.width,t.height=e.height}}}},109:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=i(s(959)),a=i(s(122)),d=i(s(151));e.default=class{constructor(t=new d.default(0,0)){this.position=t,this.states={update:!1,input:!1,render:!1},this.actions={input:t=>this.onInput(t.detail),update:t=>this.onUpdate(t.detail),render:t=>this.onRender(t.detail)},this.input=!1,this.update=!0,this.render=!0}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t}set y(t){this.position.y=t}get input(){return this.states.input}set input(t){const{states:e,actions:s}=this;t&&!e.input?(e.input=!0,this.on(a.default.INPUT,s.input)):!t&&e.input&&(this.off(a.default.INPUT,s.input),e.input=!1)}get update(){return this.states.update}set update(t){const{states:e,actions:s}=this;t&&!e.update?(e.update=!0,this.on(a.default.UPDATE,s.update)):!t&&e.update&&(this.off(a.default.UPDATE,s.update),e.update=!1)}get render(){return this.states.render}set render(t){const{states:e,actions:s}=this;t&&!e.render?(e.render=!0,this.on(a.default.RENDER,s.render)):!t&&e.render&&(this.off(a.default.RENDER,s.render),e.render=!1)}isAt(t){return this.position.isAt(t)}onInput(t){}onUpdate(t){}onRender(t){}on(t,e,s){n.default.on(t,e,s)}off(t,e){n.default.off(t,e)}dispatch(t,e){n.default.dispatch(t,e)}}},122:(t,e)=>{var s;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.START="game-start",t.STOP="game-stop",t.RESET="game-reset",t.PAUSE="game-pause",t.RESUME="game-resume",t.RESIZE="game-resize",t.RESIZE_COMPLETE="game-resize-complete",t.INPUT="game-input",t.UPDATE="game-update",t.UPDATE_COMPLETE="game-update-complete",t.RENDER="game-render",t.RENDER_COMPLETE="game-render-complete",t.GAME_OVER="game-over"}(s||(s={})),e.default=s},70:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e){this.width=t,this.height=e}get ratio(){const{height:t,width:e}=this;return t&&e?t/e:0}}},151:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(t,e){this.x=t,this.y=e}isAt(t){return this.x===t.x&&this.y===t.y}copy(){return new s(this.x,this.y)}}e.default=s},426:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=i(s(352)),a=i(s(190)),d=i(s(544)),o=i(s(390)),l=i(s(162)),u=i(s(64)),r=i(s(328)),h=i(s(228)),c=i(s(70)),f={width:40,height:30,size:20},p=document.getElementById("game-container"),m=new r.default,E=(new a.default(f),new d.default(f)),_=new n.default(f),T=new o.default(E,_),R=new u.default,v=(new l.default(R,T),new h.default);p.append(T.html),p.append(m.html),p.append(v.html),p.append(R.html),m.start(new c.default(f.width*f.size,f.height*f.size))},184:(t,e)=>{var s;Object.defineProperty(e,"__esModule",{value:!0}),e.getDisplay=void 0,function(t){t.NONE="display-none",t.LANDSCAPE="display-landscape",t.PORTRAIT="display-portrait"}(s||(s={})),e.getDisplay=t=>t?t>1?s.PORTRAIT:s.LANDSCAPE:s.NONE,e.default=s},694:(t,e)=>{var s;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.UP="UP",t.DOWN="DOWN",t.LEFT="LEFT",t.RIGHT="RIGHT"}(s||(s={})),e.default=s}},e={};!function s(i){var n=e[i];if(void 0!==n)return n.exports;var a=e[i]={exports:{}};return t[i].call(a.exports,a,a.exports,s),a.exports}(426)})();